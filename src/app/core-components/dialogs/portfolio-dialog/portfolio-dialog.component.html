<p-dialog
  [header]="getDialogHeader()"
  [(visible)]="visible"
  [draggable]="false"
  [resizable]="false"
  [modal]="true"
  styleClass="!rounded-b-[0px] !rounded-t-[24px] sm:!rounded-[24px] md:max-w-[600px] lg:max-w-[906px] w-full !bg-G50 sm:mx-[16px] max-sm:!mt-[127px] max-sm:absolute max-sm:left-0 max-sm:bottom-0"
>
  <div class="py-[24px] px-[16px] sm:px-[40px] flex flex-col gap-[24px]">
    <form
      [formGroup]="portfolioForm"
      class="flex flex-col gap-[24px]"
      novalidate
    >
      <!-- Project Name Field -->
      <fieldset class="flex flex-col gap-[8px]">
        <div class="text-b1 text-G900">
          Project Name <span class="text-R900">*</span>
        </div>
        <input
          type="text"
          #projectName
          name="projectName"
          formControlName="projectName"
          required
          placeholder="Enter the project name"
          class="w-full rounded-xl outline-none py-[8px] px-[16px] border border-G200 text-G500 text-b1 bg-G50 font-sans"
        />
      </fieldset>

      <!-- Project Description Field -->
      <fieldset class="flex flex-col gap-[8px]">
        <div class="text-b1 text-G900">
          Project Description <span class="text-R900">*</span>
        </div>
        <textarea
          type="text"
          #projectDescription
          name="projectDescription"
          formControlName="projectDescription"
          required
          placeholder="Describe the project"
          class="w-full outline-none h-[200px] border border-G200 bg-G50 rounded-xl p-[16px] text-b1 font-sans placeholder:text-G500"
        ></textarea>
        <div class="flex justify-end">
          {{ this.portfolioForm?.value?.projectDescription?.length || 0 }}/2500
        </div>
      </fieldset>

      <!-- Skill Tags Selection Component -->
      <fieldset class="flex flex-col gap-[8px]">
        <div class="text-b1 text-G900">
          Skill Tags (20 max) <span class="text-R900">*</span>
        </div>
        <skill-tags-selection
          (tagsUpdated)="skillTagsUpdated($event)"
          [initialTags]="updatedTags"
          [minimumTags]="0"
        ></skill-tags-selection>
        <input hidden #tags formControlName="tags" type="text" name="tags" />
      </fieldset>

      <!-- Project URL Field -->
      <fieldset class="flex flex-col gap-[8px]">
        <div class="text-b1 text-G900">
          Project URL
        </div>
        <input
          type="url"
          #projectUrl
          name="projectUrl"
          formControlName="projectUrl"
          placeholder="Enter the project URL (optional)"
          class="w-full rounded-xl outline-none py-[8px] px-[16px] border border-G200 text-G500 text-b1 bg-G50 font-sans"
        />
      </fieldset>

      <!-- Attachments Field -->
      <fieldset class="flex flex-col gap-[8px]">
        <div class="text-b1 text-G900">
          Attachments
        </div>
        <div
          class="w-max rounded-full overflow-hidden border-[5px] border-white relative cursor-pointer hover:opacity-80 active:opacity-100 transition-opacity duration-200"
          (click)="fileInput.click()"
        >
          <div
            *ngIf="!selectedFile"
            class="bg-G400 w-[120px] h-[120px]"
          ></div>
          <img
            *ngIf="selectedFile"
            [src]="selectedFileUrl"
            alt="attachment"
            class="w-[120px] h-[120px] bg-cover select-none"
          />
          <img
            src="/assets/massimo/images/imagePlus.png"
            alt="Add Attachment"
            class="absolute top-[40px] left-[40px] w-[40px] h-[40px] select-none"
          />
          <input
            #fileInput
            id="file-upload"
            type="file"
            accept="image/jpg,image/png,image/jpeg,application/pdf"
            hidden
            (change)="detectFiles($event)"
          />
        </div>
      </fieldset>
    </form>

    <!-- Modal Footer with Save and Cancel Buttons -->
    <div class="flex gap-[16px] items-center justify-end">
      <div
        class="cursor-pointer text-R900 font-medium text-nowrap text-b1"
        (click)="onClose()"
      >
        Cancel
      </div>
      <basic-button
        [type]="1"
        title="Save Changes"
        size="small"
        [disabled]="!portfolioForm.valid"
        (click)="onSave($event)"
      />
    </div>
  </div>
</p-dialog>
